"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{1520:()=>{let e=[{type:"main",data:[{name:"FIGHT_PROP_HP",data:4780,percent:!1},{name:"FIGHT_PROP_HP_PERCENT",data:46.6,percent:!0},{name:"FIGHT_PROP_ATTACK",data:311,percent:!1},{name:"FIGHT_PROP_ATTACK_PERCENT",data:46.6,percent:!0},{name:"FIGHT_PROP_DEFENSE_PERCENT",data:58.3,percent:!0},{name:"FIGHT_PROP_CRITICAL",data:31.1,percent:!0},{name:"FIGHT_PROP_CRITICAL_HURT",data:62.2,percent:!0},{name:"FIGHT_PROP_ELEMENT_MASTERY",data:187,percent:!1},{name:"FIGHT_PROP_CHARGE_EFFICIENCY",data:38.7,percent:!0},{name:"FIGHT_PROP_FIRE_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_GRASS_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_WATER_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_ELEC_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_ROCK_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_WIND_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_ICE_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_PHYSICAL_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_HEAL_ADD",data:35.9,percent:!0}]},{type:"sub",data:[{name:"FIGHT_PROP_HP",data:299,percent:!1},{name:"FIGHT_PROP_HP_PERCENT",data:5.8,percent:!0},{name:"FIGHT_PROP_DEFENSE",data:23,percent:!1},{name:"FIGHT_PROP_DEFENSE_PERCENT",data:7.3,percent:!0},{name:"FIGHT_PROP_ATTACK",data:23,percent:!1},{name:"FIGHT_PROP_ATTACK_PERCENT",data:7.3,percent:!0},{name:"FIGHT_PROP_ELEMENT_MASTERY",data:23,percent:!1},{name:"FIGHT_PROP_CHARGE_EFFICIENCY",data:6.5,percent:!0},{name:"FIGHT_PROP_CRITICAL",data:3.9,percent:!0},{name:"FIGHT_PROP_CRITICAL_HURT",data:7.8,percent:!1}]}],a={1:{main:["hp"],sub:["hp","atk","def","crit_rate","crit_dmg","elem","charge"]},2:{main:["atk"],sub:["hp","atk","def","crit_rate","crit_dmg","elem","charge"]},3:{main:["atk","hp","def","charge","elem"],sub:["hp","atk","def","crit_rate","crit_dmg","elem","charge"]},4:{main:["atk","hp","def","elem","physical_dmg","fire_dmg","ice_dmg","elec_dmg","wind_dmg","rock_dmg","water_dmg","grass_dmg"],sub:["hp","atk","def","crit_rate","crit_dmg","elem","charge"]},5:{main:["atk","hp","def","crit_rate","crit_dmg","elem","heal"],sub:["hp","atk","def","crit_rate","crit_dmg","elem","charge"]}},t=[{fieldName:"FIGHT_PROP_HP",icon:"IconHP",type:"hp",name:"生命值",percent:!1,range:[209,239,269,299],isMain:!1},{fieldName:"FIGHT_PROP_HP_PERCENT",icon:"IconHP",type:"hp",name:"生命值%數",percent:!0,range:[4.1,4.7,5.3,5.8],isMain:!1},{fieldName:"FIGHT_PROP_DEFENSE",icon:"IconDefense",type:"def",name:"防禦力",percent:!1,range:[16,19,21,23],isMain:!1},{fieldName:"FIGHT_PROP_DEFENSE_PERCENT",icon:"IconDefense",type:"def",name:"防禦力%數",percent:!0,range:[5.1,5.8,6.6,7.3],isMain:!1},{fieldName:"FIGHT_PROP_ATTACK",icon:"IconAttack",type:"atk",name:"攻擊力",percent:!1,range:[16,19,21,23],isMain:!1},{fieldName:"FIGHT_PROP_ATTACK_PERCENT",icon:"IconAttack",type:"atk",name:"攻擊力%數",percent:!0,range:[4.1,4.7,5.3,5.8],isMain:!1},{fieldName:"FIGHT_PROP_ELEMENT_MASTERY",icon:"IconMastery",type:"elem",name:"元素精通",percent:!1,range:[16,19,21,23]},{fieldName:"FIGHT_PROP_CHARGE_EFFICIENCY",icon:"IconChargeEfficiency",type:"charge",name:"元素充能效率",percent:!0,range:[4.5,5.2,5.8,6.5],isMain:!1},{fieldName:"FIGHT_PROP_CRITICAL",icon:"IconCritical",type:"crit_rate",name:"暴擊率",percent:!0,range:[2.7,3.1,3.5,3.9],isMain:!1},{fieldName:"FIGHT_PROP_CRITICAL_HURT",icon:"IconCriticalHurt",type:"crit_dmg",name:"暴擊傷害",percent:!0,range:[5.4,6.2,7,7.8],isMain:!1},{fieldName:"FIGHT_PROP_FIRE_ADD_HURT",icon:"IconFire",type:"fire_dmg",name:"火屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_GRASS_ADD_HURT",icon:"IconGrass",type:"grass_dmg",name:"草屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_WATER_ADD_HURT",icon:"IconWater",type:"water_dmg",name:"水屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_ELEC_ADD_HURT",icon:"IconElec",type:"elec_dmg",name:"雷屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_ROCK_ADD_HURT",icon:"IconRock",type:"rock_dmg",name:"岩屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_WIND_ADD_HURT",icon:"IconWind",type:"wind_dmg",name:"風屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_ICE_ADD_HURT",icon:"IconIce",type:"ice_dmg",name:"冰屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_PHYSICAL_ADD_HURT",icon:"IconPhysics",type:"phy_dmg",name:"物理傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_HEAL_ADD",icon:"IconHeal",type:"heal_rate",name:"治療加成",percent:!0,isMain:!0}];onmessage=function(n){var _;let r,i=n.data.SubData,c=parseInt(n.data.partsIndex),d=t.find(e=>e.name===n.data.MainData),m=n.data.limit,P=n.data.enchanceCount,p=n.data.standard,l=[];if(p.filter(e=>null!=e.SelectPriority&&0!==e.SelectPriority).forEach((e,a)=>{if(l.length<2){let a=i.findIndex(a=>a.subaffix===e.name);a>=0&&l.push(a)}}),0===l.length&&i.filter(e=>e.isSelect).forEach((e,a)=>{l.push(a)}),l.length<2){for(let e=0;e<i.length&&(l.includes(e)||(l.push(e),2!==l.length));e++);console.log(l)}let o=function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,_=[];return!function r(i,c){if(i.length===a){c===e&&t.reduce((e,a)=>e+i[a],0)>=n&&_.push([...i]);return}for(let a=0;a<=e-c;a++)i.push(a),r(i,c+a),i.pop()}([],0),_}(P,i.filter(e=>!e.locked).length,l,m),T=Math.floor(Math.random()*o.length),I=(_=n.data.standard,r={hp:0,atk:0,def:0,crit_rate:0,crit_dmg:0,elem:0,charge:0,fire_dmg:0,ice_dmg:0,water_dmg:0,elec_dmg:0,rock_dmg:0,wind_dmg:0,grass_dmg:0,phy_dmg:0,heal_rate:0},_.forEach(e=>{r[t.find(a=>a.name===e.name).type]=parseFloat(e.value)}),r),R=[];i.forEach(e=>{let a=t.find(a=>a.name===e.subaffix);R.push({type:a.type,fieldName:a.fieldName,num:Number(I[a.type]),locked:!!e.locked})});let s=I[d.type],f=0;new Promise(async(n,_)=>{var r,d;let m,P,p,l=o[T],H=function(e){let a=[],t=[0,1,2,3];return!function n(_,r){if(_===e.length)return void a.push([...r]);let i=e[_],c=[];for(let e of(!function e(a){if(a.length===i)return void c.push([...a]);for(let n of t)a.push(n),e(a),a.pop()}([]),c))r.push(e),n(_+1,r),r.pop()}(0,[]),a}(l),g=Math.floor(Math.random()*H.length),E=H[g],h=0;1!==c&&2!==c&&(h=3*s);let F=[],u=[];E.forEach((a,n)=>{let _=0,r=R[n],c=t.find(e=>e.fieldName===r.fieldName).range;_=0===i[n].count?i[n].data:c[1],a.forEach(e=>_+=c[e]);let d=e.find(e=>"sub"===e.type).data.find(e=>e.name===r.fieldName).data,m=parseFloat(_/d).toFixed(2),P=parseFloat(I[r.type]*m);F.push({type:r.fieldName,affixmutl:P}),u.push({index:u.length,subaffix:i[n].subaffix,data:parseFloat(_.toFixed(1)),count:l[n]})}),F.forEach(e=>{"FIGHT_PROP_HP"!==e.type&&"FIGHT_PROP_DEFENSE"!==e.type&&"FIGHT_PROP_ATTACK"!==e.type&&(h+=e.affixmutl)}),f=Number((100*parseFloat(h/(r=I,d=c,m=5,P="",r=Object.entries(r).sort((e,a)=>a[1]-e[1]),1!==d&&2!==d&&(r.forEach(e=>{let[t,n]=e,_=!a[d].sub.includes(t);a[d].main.includes(t)&&""===P&&_&&0!==n&&(P=t,m+=3*n)}),""===P&&r.forEach(e=>{let[t,n]=e;a[d].main.includes(t)&&""===P&&(P=t,m+=3*n)})),p=0,r.forEach(e=>{let[t,n]=e;t!==P&&p<4&&a[d].sub.includes(t)&&(m+=n,p+=1)}),m))).toFixed(2)),n(u)}).then(e=>{let a,t=[{rank:"S+",stand:85,color:"rgb(239, 68, 68)",tag:"S+"},{rank:"S",stand:70,color:"rgb(239, 68, 68)",tag:"S"},{rank:"A",stand:50,color:"rgb(234, 179, 8)",tag:"A"},{rank:"B",stand:35,color:"rgb(234, 88 , 12)",tag:"B"},{rank:"C",stand:15,color:"rgb(163, 230, 53)",tag:"C"},{rank:"D",stand:0,color:"rgb(22,163,74)",tag:"D"}];t.reverse();let n=!0;t.forEach((e,_)=>{f<e.stand&&n&&0!==_&&(n=!1,a=t[_-1]),_===t.length-1&&n&&(n=!1,a=t[_]),e.stand<=origin&&void 0===a&&(a=e)}),this.postMessage({relicscore:Number(f.toFixed(1)),relicrank:a,returnData:e})})}}}]);