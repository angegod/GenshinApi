"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[594],{8594:()=>{let e=[{type:"main",data:[{name:"FIGHT_PROP_HP",data:4780,percent:!1},{name:"FIGHT_PROP_HP_PERCENT",data:46.6,percent:!0},{name:"FIGHT_PROP_ATTACK",data:311,percent:!1},{name:"FIGHT_PROP_ATTACK_PERCENT",data:46.6,percent:!0},{name:"FIGHT_PROP_DEFENSE_PERCENT",data:58.3,percent:!0},{name:"FIGHT_PROP_CRITICAL",data:31.1,percent:!0},{name:"FIGHT_PROP_CRITICAL_HURT",data:62.2,percent:!0},{name:"FIGHT_PROP_ELEMENT_MASTERY",data:187,percent:!1},{name:"FIGHT_PROP_CHARGE_EFFICIENCY",data:38.7,percent:!0},{name:"FIGHT_PROP_FIRE_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_GRASS_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_WATER_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_ELEC_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_ROCK_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_WIND_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_ICE_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_PHYSICAL_ADD_HURT",data:46.6,percent:!0},{name:"FIGHT_PROP_HEAL_ADD",data:35.9,percent:!0}]},{type:"sub",data:[{name:"FIGHT_PROP_HP",data:299,percent:!1},{name:"FIGHT_PROP_HP_PERCENT",data:5.8,percent:!0},{name:"FIGHT_PROP_DEFENSE",data:23,percent:!1},{name:"FIGHT_PROP_DEFENSE_PERCENT",data:7.3,percent:!0},{name:"FIGHT_PROP_ATTACK",data:23,percent:!1},{name:"FIGHT_PROP_ATTACK_PERCENT",data:7.3,percent:!0},{name:"FIGHT_PROP_ELEMENT_MASTERY",data:23,percent:!1},{name:"FIGHT_PROP_CHARGE_EFFICIENCY",data:6.5,percent:!0},{name:"FIGHT_PROP_CRITICAL",data:3.9,percent:!0},{name:"FIGHT_PROP_CRITICAL_HURT",data:7.8,percent:!1}]}],a={1:{main:["hp"],sub:["hp","atk","def","crit_rate","crit_dmg","elem","charge"]},2:{main:["atk"],sub:["hp","atk","def","crit_rate","crit_dmg","elem","charge"]},3:{main:["atk","hp","def","charge","elem"],sub:["hp","atk","def","crit_rate","crit_dmg","elem","charge"]},4:{main:["atk","hp","def","elem","physical_dmg","fire_dmg","ice_dmg","elec_dmg","wind_dmg","rock_dmg","water_dmg","grass_dmg"],sub:["hp","atk","def","crit_rate","crit_dmg","elem","charge"]},5:{main:["atk","hp","def","crit_rate","crit_dmg","elem","heal"],sub:["hp","atk","def","crit_rate","crit_dmg","elem","charge"]}},t=[{fieldName:"FIGHT_PROP_HP",icon:"IconHP",type:"hp",name:"生命值",percent:!1,range:[209,239,269,299],isMain:!1},{fieldName:"FIGHT_PROP_HP_PERCENT",icon:"IconHP",type:"hp",name:"生命值%數",percent:!0,range:[4.1,4.7,5.3,5.8],isMain:!1},{fieldName:"FIGHT_PROP_DEFENSE",icon:"IconDefense",type:"def",name:"防禦力",percent:!1,range:[16,19,21,23],isMain:!1},{fieldName:"FIGHT_PROP_DEFENSE_PERCENT",icon:"IconDefense",type:"def",name:"防禦力%數",percent:!0,range:[5.1,5.8,6.6,7.3],isMain:!1},{fieldName:"FIGHT_PROP_ATTACK",icon:"IconAttack",type:"atk",name:"攻擊力",percent:!1,range:[16,19,21,23],isMain:!1},{fieldName:"FIGHT_PROP_ATTACK_PERCENT",icon:"IconAttack",type:"atk",name:"攻擊力%數",percent:!0,range:[4.1,4.7,5.3,5.8],isMain:!1},{fieldName:"FIGHT_PROP_ELEMENT_MASTERY",icon:"IconMastery",type:"elem",name:"元素精通",percent:!1,range:[16,19,21,23]},{fieldName:"FIGHT_PROP_CHARGE_EFFICIENCY",icon:"IconChargeEfficiency",type:"charge",name:"元素充能效率",percent:!0,range:[4.5,5.2,5.8,6.5],isMain:!1},{fieldName:"FIGHT_PROP_CRITICAL",icon:"IconCritical",type:"crit_rate",name:"暴擊率",percent:!0,range:[2.7,3.1,3.5,3.9],isMain:!1},{fieldName:"FIGHT_PROP_CRITICAL_HURT",icon:"IconCriticalHurt",type:"crit_dmg",name:"暴擊傷害",percent:!0,range:[5.4,6.2,7,7.8],isMain:!1},{fieldName:"FIGHT_PROP_FIRE_ADD_HURT",icon:"IconFire",type:"fire_dmg",name:"火屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_GRASS_ADD_HURT",icon:"IconGrass",type:"grass_dmg",name:"草屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_WATER_ADD_HURT",icon:"IconWater",type:"water_dmg",name:"水屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_ELEC_ADD_HURT",icon:"IconElec",type:"elec_dmg",name:"雷屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_ROCK_ADD_HURT",icon:"IconRock",type:"rock_dmg",name:"岩屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_WIND_ADD_HURT",icon:"IconWind",type:"wind_dmg",name:"風屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_ICE_ADD_HURT",icon:"IconIce",type:"ice_dmg",name:"冰屬性傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_PHYSICAL_ADD_HURT",icon:"IconPhysics",type:"phy_dmg",name:"物理傷害加成",percent:!0,isMain:!0},{fieldName:"FIGHT_PROP_HEAL_ADD",icon:"IconHeal",type:"heal_rate",name:"治療加成",percent:!0,isMain:!0}];function n(e,t){let n=5,r="";e=Object.entries(e).sort((e,a)=>a[1]-e[1]),1!==t&&2!==t&&(e.forEach(e=>{let[i,_]=e,c=!a[t].sub.includes(i);a[t].main.includes(i)&&""===r&&c&&0!==_&&(r=i,n+=3*_)}),""===r&&e.forEach(e=>{let[i,_]=e;a[t].main.includes(i)&&""===r&&(r=i,n+=3*_)}));let i=0;return e.forEach(e=>{let[_,c]=e;_!==r&&i<4&&a[t].sub.includes(_)&&(n+=c,i+=1)}),n}onmessage=function(a){var r,i,_,c;let d,l,m,p,P=a.data.SubData,o=parseInt(a.data.partsIndex),f=t.find(e=>e.name===a.data.MainData),T=void 0!==a.data.deviation?a.data.deviation:0,s=a.data.limit,R=a.data.standard,I=a.data.enchanceCount;R=R.sort((e,a)=>e.SelectPriority-a.SelectPriority);let E=[];if(R.filter(e=>null!=e.SelectPriority&&0!==e.SelectPriority).forEach((e,a)=>{if(E.length<2){let a=P.findIndex(a=>a.subaffix===e.name);a>=0&&E.push(a)}}),0===E.length&&P.filter(e=>e.isSelect).forEach((e,a)=>{E.push(a)}),E.length<2){for(let e=0;e<P.length&&(E.includes(e)||(E.push(e),2!==E.length));e++);console.log(E)}let H=function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=[];return!function i(_,c){if(_.length===a){c===e&&t.reduce((e,a)=>e+_[a],0)>=n&&r.push([..._]);return}for(let a=0;a<=e-c;a++)_.push(a),i(_,c+a),_.pop()}([],0),r}(I,P.length,E,s),g=(d={hp:0,atk:0,def:0,crit_rate:0,crit_dmg:0,elem:0,charge:0,fire_dmg:0,ice_dmg:0,water_dmg:0,elec_dmg:0,rock_dmg:0,wind_dmg:0,grass_dmg:0,phy_dmg:0,heal_rate:0},R.forEach(e=>{d[t.find(a=>a.name===e.name).type]=parseFloat(e.value)}),d),F=[];P.forEach(e=>{let a=t.find(a=>a.name===e.subaffix);F.push({type:a.type,fieldName:a.fieldName,num:Number(g[a.type])})});let h=g[f.type],u=[],N=(r=o,i=g,_=P,c=h,l=0,m=[],1!==r&&2!==r&&(l+=3*c),_.forEach(a=>{var n=parseFloat(a.data).toFixed(2);let r=t.find(e=>e.name===a.subaffix);var _=parseFloat(n/e.find(e=>"sub"===e.type).data.find(e=>e.name===r.fieldName).data).toFixed(2);let c=parseFloat(i[r.type]*_);m.push({type:r.fieldName,affixmutl:c})}),m.forEach(e=>{"FIGHT_PROP_HP"!==e.type&&"FIGHT_PROP_DEFENSE"!==e.type&&"FIGHT_PROP_ATTACK"!==e.type&&(l+=e.affixmutl)}),p=0,parseFloat(100*parseFloat(l/n(i,r))).toFixed(1));new Promise(async(a,r)=>{H.forEach((a,r)=>{(function(e){let a=[],t=[0,1,2,3];return!function n(r,i){if(r===e.length)return void a.push([...i]);let _=e[r],c=[];for(let e of(!function e(a){if(a.length===_)return void c.push([...a]);for(let n of t)a.push(n),e(a),a.pop()}([]),c))i.push(e),n(r+1,i),i.pop()}(0,[]),a})(a).forEach(a=>{let r=0;1!==o&&2!==o&&(r=3*h);let i=0,_=[];a.forEach((a,n)=>{let r=F[n],c=t.find(e=>e.fieldName===r.fieldName).range;i=c[1],a.forEach(e=>i+=c[e]);let d=e.find(e=>"sub"===e.type).data.find(e=>e.name===r.fieldName).data,l=parseFloat(i/d).toFixed(2),m=parseFloat(g[r.type]*l);_.push({type:r.fieldName,affixmutl:m})}),_.forEach(e=>{"FIGHT_PROP_HP"!==e.type&&"FIGHT_PROP_DEFENSE"!==e.type&&"FIGHT_PROP_ATTACK"!==e.type&&(r+=e.affixmutl)});let c=Number((100*parseFloat(r/n(g,o))).toFixed(2));u.push(c)})}),a(N)}).then(e=>{let a,t=JSON.parse(JSON.stringify(u)).filter(e=>e-T>Number(N)).length/u.length.toFixed(2),n=JSON.parse(JSON.stringify(u)),r=[];[{rank:"S+",stand:85,color:"rgb(239, 68, 68)",tag:"S+"},{rank:"S",stand:70,color:"rgb(239, 68, 68)",tag:"S"},{rank:"A",stand:50,color:"rgb(234, 179, 8)",tag:"A"},{rank:"B",stand:35,color:"rgb(234, 88 , 12)",tag:"B"},{rank:"C",stand:15,color:"rgb(163, 230, 53)",tag:"C"},{rank:"D",stand:0,color:"rgb(22,163,74)",tag:"D"}].forEach((e,t)=>{let i=n.filter(a=>a>=e.stand);n=n.filter(a=>a<e.stand);let _=Number((100*parseFloat(i.length/u.length)).toFixed(2));r.push({label:e.tag,value:_||0,color:e.color,tag:e.rank}),e.stand<=N&&void 0===a&&(a=e)}),0===r.filter(e=>0!==e.value).length&&(r.find(e=>e.label===a.rank).value=100),this.postMessage({expRate:t||0,relicscore:e,relicrank:a,returnData:r})})}}}]);