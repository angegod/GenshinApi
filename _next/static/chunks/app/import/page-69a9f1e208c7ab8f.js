(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[322],{254:(e,s,t)=>{Promise.resolve().then(t.bind(t,3058))},3058:(e,s,t)=>{"use strict";t.d(s,{default:()=>b});var a=t(5155),l=t(2115),r=t(2540),i=t(7665),n=t(7260);t(9193);var c=t(3464),x=t(5424),d=t(5695),o=t(8637),m=t(7901),h=t(8390),f=t(1582),p=t(3848),u=t(9779),j=t(4422),v=t(3336);let N=function(){return(0,a.jsxs)("div",{className:"flex flex-col max-w-[250px] p-1",children:[(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"text-white",children:"此區塊可以查看過往查詢紀錄，下面為個別功能相關簡述。"})}),(0,a.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,a.jsx)("span",{className:"text-md font-bold text-white",children:"檢視"}),(0,a.jsx)("span",{className:"text-stone-400",children:"可以查看曾經查詢出來的資訊、包括遺器、評分標準等"})]}),(0,a.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"text-white font-bold",children:"更新"})}),(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"text-stone-400",children:"點選後會根據該紀錄原本的參數再查詢一次，並且將新結果更新至掉該筆紀錄中。"})})]}),(0,a.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"text-md font-bold text-white",children:"刪除"})}),(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"text-stone-400",children:"刪除該筆紀錄"})})]}),(0,a.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"text-md font-bold text-white",children:"注意事項"})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"!text-red-500",children:'"過往紀錄"最多只保留6筆'}),(0,a.jsx)("span",{className:"!text-yellow-500",children:"如果在已有6筆資料的情況再新增，則會從最舊的紀錄開始覆蓋掉"})]})]})]})},w=function(){return(0,a.jsxs)("div",{className:"w-[300px] flex flex-col max-[600px]:my-3",children:[(0,a.jsx)("h2",{className:"text-red-600 font-bold text-lg",children:"使用說明"}),(0,a.jsxs)("ul",{className:"[&>li]:text-white list-decimal [&>li]:ml-2 max-[400px]:[&>li]:text-sm",children:[(0,a.jsx)("li",{children:"此工具會根據玩家放在展示框的12個腳色身上的聖遺物做數據分析"}),(0,a.jsx)("li",{children:"翻盤機率是指該聖遺物透過重洗詞條道具後分數變高的機率為何"}),(0,a.jsx)("li",{children:"目前該工具只支援計算五星強化至滿等聖遺物"}),(0,a.jsx)("li",{children:"此工具相關數據仍有更改的可能，敬請見諒!"}),(0,a.jsx)("li",{children:"如果發現服務頻繁發生錯誤，可以先使用simulator。"}),(0,a.jsxs)("li",{children:["操作說明可以參考",(0,a.jsx)("a",{href:"https://home.gamer.com.tw/artwork.php?sn=6065608",className:"!underline",children:"這篇"})]})]})]})},g=function(){return(0,a.jsxs)("div",{className:"flex flex-col w-[300px]",children:[(0,a.jsxs)("div",{className:"flex flex-col [&>span]:mb-1",children:[(0,a.jsx)("span",{children:"此區會顯示匹配這筆資料時所使用的詞條、其加權指數以及其指定優先級"}),(0,a.jsx)("span",{children:"下面講述加權指數跟指定優先級使用"})]}),(0,a.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"text-white font-bold",children:"加權指數"})}),(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"text-stone-400",children:"每個詞條的分數占比，占比越高代表你越看重這個詞條。"})})]}),(0,a.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"text-md font-bold text-white",children:"指定優先級"})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-stone-400",children:"系統看到該種類的副屬性詞條，被選定為強化保底詞條的優先級"}),(0,a.jsx)("span",{className:"text-yellow-400 font-bold",children:"數字越大則優先級越高"})]})]}),(0,a.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"font-bold",children:"注意事項"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-red-500 font-bold",children:"如果該詞條只會出現在主詞條上，則該詞條不可被指定"}),(0,a.jsx)("span",{className:"text-red-500 font-bold",children:"如果該聖遺物無法經過你指定的詞條種類標記兩個指定詞條，則系統自動給予其中一個非指定詞條為指定詞條。"})]})]})]})},b=function(){let e=(0,l.useRef)(""),[s,b]=(0,l.useState)(void 0),[S,I]=(0,l.useState)(),[k,y]=(0,l.useState)(0),[D,R]=(0,l.useState)(2),[A,C]=(0,l.useState)(void 0),[H,E]=(0,l.useState)(void 0),[O,P]=(0,l.useState)({color:void 0,rank:void 0}),[_,J]=(0,l.useState)(void 0),[F,T]=(0,l.useState)(3),[B,q]=(0,l.useState)([]),L=(0,l.useRef)(null),{showStatus:M,updateStatus:U,hideStatus:V}=(0,j.Z)(),G="GenshinImporterData",{setHistory:z,getHistory:Q,addHistory:W,deleteHistory:Y,resetHistory:Z,limitHistory:$}=(0,v.A)(),[K,X]=(0,l.useState)(!1),[ee,es]=(0,l.useState)([]),et=(0,l.useRef)([]),ea=(0,d.usePathname)(),[el,er]=(0,l.useState)(!0),[ei,en]=(0,l.useState)(!1),ec=[{rank:"S+",stand:85,color:"rgb(239, 68, 68)",tag:"S+"},{rank:"S",stand:70,color:"rgb(239, 68, 68)",tag:"S"},{rank:"A",stand:50,color:"rgb(234, 179, 8)",tag:"A"},{rank:"B",stand:35,color:"rgb(234, 88 , 12)",tag:"B"},{rank:"C",stand:15,color:"rgb(163, 230, 53)",tag:"C"},{rank:"D",stand:0,color:"rgb(22,163,74)",tag:"D"}];async function ex(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,l="http://localhost:3000"===window.location.origin?"http://localhost:5000/artifact/get":"https://expressapi-o9du.onrender.com/artifact/get";if(!t){if(!/^\d+$/.test(e.current)||!e.current)return void U("請輸入有效的UID!!","error");if(!s)return void U("未選擇任何腳色!!","error");if(!ee||0===ee.length)return void U("至少選擇一項加權!!","error");if(ee.filter(e=>e.SelectPriority>0).length<2)return void U("優先指定詞條至少需要兩個!","error");if(D>4||D<2)return void U("保底次數只能為2,3或4次!","error");t={uid:e.current,charID:s}}a||(a=[...ee]),en(!1),M("正在尋找匹配資料......"),er(!1),C(void 0),P({color:void 0,rank:void 0}),J(void 0),E(void 0),q([]),I(),await c.A.post(l,t,{headers:{"Content-Type":"application/json"}}).then(async e=>{switch(e.data){case 800:U("找不到該腳色。必須要將腳色放在展示區才可以抓到資料!!","error"),er(!0);break;case 801:U("找不到該部件的聖遺物，如果是剛剛才更新的話建議等五分鐘再使用一次!!","error"),er(!0);break;case 802:U("該聖遺物等級尚未強化至滿等，請先強化至滿等後再嘗試!","error"),er(!0);break;case 803:U("該聖遺物非五星遺器，請選擇部位為五星強化滿等之聖遺物","error"),er(!0);break;case 804:U("該腳色並未穿著五星聖遺物！！","error"),er(!0);break;case 810:U("溝通次數太過於頻繁 請稍後再試!!","error"),er(!0);break;case 900:U("系統正在維護\n請稍後再試!","error"),er(!0);break;default:await ed(e.data,a)}}).catch(e=>{console.log(e),e.response&&429===e.response.status?U("請求次數過於頻繁\n請稍後再試!!","error"):U("系統正在維護中\n請稍後再試!!","error"),er(!0)})}async function ed(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,l=[];for(let c of(a.forEach(e=>{if(""===e.value)return void U("加權指數不可為空或其他非法型式","error")}),e)){let e={};for(var r=3;r<=4;r++){let l=await function(e,a,l){return new Promise(r=>{let c=new Worker(t.tu(new URL(t.p+t.u(63),t.b))),x=i.A.find(s=>s.fieldName===e.flat.reliquaryMainstat.mainPropId),d=[];e.flat.reliquarySubstats.forEach((e,s)=>{let t=i.A.find(s=>s.fieldName===e.appendPropId),a=e.statValue,l={index:s,subaffix:t.name,data:a};d.push(l)});let o={charID:s,MainData:x.name,SubData:d,partsIndex:n.A[e.flat.equipType],standard:a,limit:D,enchanceCount:l};M("數據計算處理中......"),c.postMessage(o),c.onmessage=function(s){r({relic:e,ExpRate:s.data.expRate,Rscore:s.data.relicscore,PieNums:s.data.returnData,Rank:s.data.relicrank,standDetails:a})}})}(c,a,r+1);e[r]=l}l.push(e)}console.log(l),0===l.length?(U("該腳色身上的聖遺物不符合重洗條件!!","default"),er(!0)):U("資料顯示完畢","success"),q(l),L.current=l,en(!0)}(0,l.useEffect)(()=>{!function(){X(!1),R(2),Z();let e=JSON.parse(localStorage.getItem(G));if(null===e){z([]),X(!0);return}M("正在載入過往紀錄中......"),e=e.filter(e=>"1.5"===e.version),localStorage.setItem(G,JSON.stringify(e)),null!=e&&e.length>0?(z(e),U("先前紀錄已匯入!!","success")):U("尚未有任何操作紀錄","default"),X(!0)}()},[ea]),(0,l.useEffect)(()=>{0!==B.length&&(I(B[k][F].relic),C(B[k][F].ExpRate),E(B[k][F].Rscore),J(B[k][F].PieNums),P(B[k][F].Rank),et.current=JSON.parse(JSON.stringify(B[k][F].standDetails)),er(!0))},[B,k,F]),(0,l.useEffect)(()=>{S&&requestAnimationFrame(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})})},[S]);let eo=(0,l.useCallback)(e=>{let s=Q(e);q([...s.dataArr]),y(0),R(s.limit),T(3),en(!1),U("資料顯示完畢","success"),requestAnimationFrame(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})})},[Q()]),em=(0,l.useCallback)(async e=>{M("正在更新資料中");let s=Q(e),t={uid:s.userID,charID:s.char.charId,partsIndex:6},a=s.dataArr[0][3].standDetails.map(e=>({...e}));R(s.limit),await ex(t,a).then(()=>{if(console.log(L.current),L.current){let t,a=0,l=0;L.current.forEach(e=>{for(var s=3;s<=4;s++)a+=Number(e[s].Rscore),l+=e[s].ExpRate});let r=Number(parseFloat(a/(2*L.current.length)).toFixed(1)),i=new Date,n=Number((100*l/(2*L.current.length)).toFixed(1));ec.forEach(e=>{e.stand<=r&&void 0===t&&(t=e)});let c={version:"1.5",calDate:i.toISOString().split("T")[0],userID:s.userID,char:s.char,dataArr:L.current,avgScore:r,avgRank:t,avgRate:n},x=JSON.parse(JSON.stringify(Q()));x[e]=c,localStorage.setItem(G,JSON.stringify(x)),z(x),U("已更新","success"),en(!1)}}).catch(e=>{console.error("錯誤發生：",e),console.error("錯誤訊息：",e.message),console.error("堆疊追蹤：",e.stack)})},[Q()]),eh=(0,l.useCallback)(e=>{let s=Q();Y(e),s=s.filter((s,t)=>t!==e),localStorage.setItem(G,JSON.stringify(s)),setTimeout(()=>{U("成功刪除該筆資料","success")},0)},[Q()]),ef={charID:s,selfStand:ee,partsIndex:6,standDetails:et.current,partArr:["生之花","死之羽","時之沙","空之杯","理之冠"],isChangeAble:el,RelicDataArr:B,relicIndex:k,isLoad:K,limit:D,relic:S,Rscore:H,Rrank:O,ExpRate:A,PieNums:_,AffixCount:F,deleteHistoryData:eh,checkDetails:eo,updateDetails:em,setCharID:b,setSelfStand:es,setIsSaveAble:en,setRelicIndex:y,setRelic:I};return(0,a.jsxs)(u.A.Provider,{value:ef,children:[(0,a.jsxs)("div",{className:"flex flex-col w-4/5 mx-auto max-[600px]:w-[95%] rounded-md ",children:[(0,a.jsx)("div",{className:"rounded-md",children:(0,a.jsxs)("div",{className:"flex flex-row flex-wrap max-[600px]:w-[95%] ",children:[(0,a.jsxs)("div",{className:"flex flex-col w-2/5 bg-[rgba(0,0,0,0.5)] rounded-md max-[1250px]:w-[100%] test",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center ml-2 mt-2",children:[(0,a.jsx)("h1",{className:"text-red-600 font-bold text-2xl",children:"遺器匯入"}),(0,a.jsx)("div",{className:"hintIcon ml-2 overflow-visible","data-tooltip-id":"ImporterHint",children:(0,a.jsx)("span",{className:"text-white",children:"?"})})]}),(0,a.jsxs)("div",{className:"flex flex-col px-2 rounded-md",children:[(0,a.jsxs)("div",{className:"flex flex-row [&>*]:mr-2 my-3 items-baseline max-[400px]:!flex-col",children:[(0,a.jsx)("div",{className:"text-right w-[200px] max-[400px]:text-left max-[600px]:w-[120px]",children:(0,a.jsx)("span",{className:"text-white",children:"玩家UID :"})}),(0,a.jsx)("input",{type:"text",placeholder:"HSR UID",className:"h-[40px] max-w-[170px] pl-2    bg-inherit text-white outline-none border-b border-white",id:"userId",onChange:s=>e.current=s.target.value,disabled:!el,autoComplete:"off"})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center [&>*]:mr-2 my-3 max-[400px]:!flex-col",children:[(0,a.jsx)("div",{className:"text-right w-[200px]  max-[400px]:text-left max-[600px]:w-[120px]",children:(0,a.jsx)("span",{className:"text-white whitespace-nowrap",children:"Characters 腳色:"})}),(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)(p.zj,{}),(0,a.jsx)("div",{className:"hintIcon ml-1 overflow-visible","data-tooltip-id":"CharHint",children:(0,a.jsx)("span",{className:"text-white",children:"?"})})]})]}),(0,a.jsxs)("div",{className:"mt-4 [&>*]:mr-2 flex flex-row items-baseline max-[400px]:!flex-col",children:[(0,a.jsx)("div",{className:"text-right w-[200px]  max-[400px]:text-left max-[600px]:w-[120px]",children:(0,a.jsx)("span",{className:"text-white whitespace-nowrap",children:"Affix 有效詞條:"})}),(0,a.jsx)("div",{className:"flex flex-row items-center",children:(0,a.jsx)(p.mM,{})})]}),(0,a.jsxs)("div",{className:"mt-2 [&>*]:mr-2 flex flex-row max-[400px]:!flex-col ".concat(0===ee.length?"hidden":""),children:[(0,a.jsx)("div",{className:"text-right w-[200px] max-[400px]:text-left max-[600px]:w-[120px]",children:(0,a.jsx)("span",{className:"text-white",children:"Params 參數:"})}),(0,a.jsxs)("div",{className:"flex flex-row items-baseline",children:[(0,a.jsx)(h.Q,{}),(0,a.jsx)("div",{className:"hintIcon ml-2 overflow-visible","data-tooltip-id":"StandDetailsHint",children:(0,a.jsx)("span",{className:"text-white",children:"?"})})]})]}),(0,a.jsxs)("div",{className:"flex flex-row my-3",children:[(0,a.jsx)("div",{className:"w-[200px] text-right",children:(0,a.jsx)("span",{className:"text-white",children:"Limit 保底次數:"})}),(0,a.jsxs)("div",{className:"pl-1 flex flex-row items-center",children:[(0,a.jsx)("input",{type:"text-white",className:"bgInput w-[40px] text-center",onChange:e=>R(parseInt(e.target.value)),defaultValue:2}),(0,a.jsx)("div",{className:"hintIcon ml-1 overflow-visible","data-tooltip-id":"LimitHint",children:(0,a.jsx)("span",{className:"text-white",children:"?"})})]})]}),(0,a.jsxs)("div",{className:"my-3 flex flex-row [&>*]:mr-2 justify-end max-w-[400px] max-[900px]:justify-center",children:[(0,a.jsx)("button",{className:"processBtn",onClick:()=>ex(),disabled:!el,children:"開始匹配"}),(0,a.jsx)("button",{className:"processBtn",onClick:()=>(function(){let t,a=r.A.find(e=>e.charId===s);if(Q().length>=6&&$(),0===B.length)return void U("當前沒有任何數據，不予儲存!!","error");if(!e.current)return void U("沒有輸入玩家ID，請再試一次!!","error");if(!s)return void U("沒有選擇任何腳色!!","error");let l=0,i=0,n=[...B];(n=n.filter(e=>{for(var s=3;s<=4;s++)if(null===e[s].Rscore||null===e[s].PieNums)return!1;return!0})).forEach(e=>{for(var s=3;s<=4;s++)l+=Number(e[s].Rscore),i+=e[s].ExpRate});let c=Number(parseFloat(l/(2*n.length)).toFixed(1)),x=new Date,d=Number((100*i/(2*n.length)).toFixed(1));ec.forEach(e=>{e.stand<=c&&void 0===t&&(t=e)});let o={version:"1.5",calDate:x.toISOString().split("T")[0],userID:e.current,char:a,dataArr:B,avgScore:c,avgRank:t,avgRate:d,limit:D},m=JSON.parse(JSON.stringify(Q()));W(o),m.push(o),U("已儲存","success"),en(!1),localStorage.setItem(G,JSON.stringify(m))})(),disabled:!ei,children:"儲存紀錄"})]})]})]}),(0,a.jsxs)("div",{className:"w-[55%] pb-3 pt-1 h-fit flex-wrap max-[1250px]:w-[100%] max-[1250px]:mb-5 ml-2 bg-[rgba(0,0,0,0.5)] rounded-md max-[1250px]:ml-0 max-[1250px]:mt-2",children:[(0,a.jsxs)("div",{className:"flex flex-row items-baseline px-2 max-[600px]:justify-center",children:[(0,a.jsx)("span",{className:"text-red-600 text-lg font-bold",children:"過往紀錄"}),(0,a.jsx)("div",{className:"hintIcon ml-2 overflow-visible","data-tooltip-id":"HistoryHint",children:(0,a.jsx)("span",{className:"text-white",children:"?"})})]}),(0,a.jsx)("div",{className:"max-h-[300px] overflow-y-scroll p-2  hiddenScrollBar flex flex-row flex-wrap max-[600px]:!flex-col max-[600px]:!flex-nowrap max-[600px]:items-center",children:(0,a.jsx)(o.f,{})})]})]})}),(0,a.jsxs)("div",{className:"flex flex-row flex-wrap mt-2 w-[100%] ".concat(B&&0!==B.length?"":"hidden"," bg-[rgba(0,0,0,0.5)] shadowBox px-2 mb-5 rounded-md"),children:[(0,a.jsx)("div",{className:"w-[100%] ".concat(void 0===B?"hidden":""," max-[500px]:justify-center"),children:(0,a.jsx)(p.aY,{})}),(0,a.jsx)("div",{className:"mt-3 flex flex-row flex-wrap w-1/4  max-[700px]:w-[50%] ".concat(S?"":"hidden"," max-[500px]:w-4/5 max-[500px]:mx-auto"),children:(0,a.jsx)(f.G,{mode:"Importer",button:!1})}),(0,a.jsx)("div",{className:"mt-3 w-1/4 max-[700px]:w-[50%] ".concat(et.current?"":"hidden"," max-[500px]:w-4/5 max-[500px]:mx-auto"),children:(0,a.jsx)(h.V,{})}),(0,a.jsxs)("div",{className:"mt-3 flex flex-col flex-wrap w-1/2 max-[700px]:w-[100%] ".concat(H?"":"hidden"," max-[500px]:w-4/5 max-[500px]:mx-auto"),id:"resultDetails",children:[_?(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("button",{className:"underline cursor-pointer",onClick:()=>void(3===F?T(4):4===F&&T(3)),children:3===F?"目前為3詞條":"目前為4詞條"}),(0,a.jsx)("div",{className:"hintIcon ml-2 overflow-visible","data-tooltip-id":"AffixCountChangeHint",children:(0,a.jsx)("span",{className:"text-white",children:"?"})})]}):null,(0,a.jsx)(m.A,{})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(x.m_,{id:"CharHint",place:"right-start",render:()=>(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-white",children:"選擇指定腳色，可以使用中文或英文關鍵字"}),(0,a.jsx)("span",{className:"text-white",children:"例如:Jingliu→鏡流"})]})}),(0,a.jsx)(x.m_,{id:"HistoryHint",place:"top-center",render:()=>(0,a.jsx)(N,{})}),(0,a.jsx)(x.m_,{id:"RelicSelectHint",place:"top-start",render:()=>(0,a.jsxs)("div",{className:"flex flex-col [&>span]:text-white max-w-[250px] p-1",children:[(0,a.jsx)("span",{children:"下方會顯示出該腳色符合條件的所有遺器"}),(0,a.jsx)("span",{children:"點選遺器即可查看個別資訊"}),(0,a.jsx)("span",{className:"!text-red-600 font-bold",children:"僅顯示符合條件的五星滿等遺器遺器"})]})}),(0,a.jsx)(x.m_,{id:"ImporterHint",place:"right-start",render:()=>(0,a.jsx)(w,{}),clickable:!0}),(0,a.jsx)(x.m_,{id:"LimitHint",place:"right-start",render:()=>(0,a.jsx)("div",{children:(0,a.jsx)("span",{children:"指定詞條們的共享保底次數，最低為2，最高為4"})}),clickable:!0}),(0,a.jsx)(x.m_,{id:"StandDetailsHint",place:"right-start",render:()=>(0,a.jsx)(g,{})}),(0,a.jsx)(x.m_,{id:"AffixCountChangeHint",place:"right-start",render:()=>(0,a.jsxs)("div",{className:"max-w-[300px]",children:[(0,a.jsx)("div",{children:(0,a.jsx)("span",{children:"此按鈕可以切換該聖遺物至3詞條或4詞條模式"})}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("span",{className:"text-yellow-400",children:"目前API無法提供該聖遺物屬於初始3或4詞條，才會設計切換按鈕。"})})]})})]})]})}},9193:()=>{}},e=>{var s=s=>e(e.s=s);e.O(0,[8,479,935,261,659,464,664,441,684,358],()=>s(254)),_N_E=e.O()}]);