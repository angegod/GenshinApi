(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[632],{1898:()=>{},2955:(e,a,l)=>{Promise.resolve().then(l.bind(l,7666))},7666:(e,a,l)=>{"use strict";l.d(a,{default:()=>v});var s=l(5155),t=l(2115),n=l(2039),i=l(3142);l(1209),l(1898);var r=l(5504),c=l(39),x=l(441),d=l(9779),o=l(6900),m=l(5695),f=l(5424);let u=function(){return(0,s.jsxs)("div",{className:"flex flex-col max-w-[250px] p-1",children:[(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-white",children:"此區塊可以操作指定遺器，模擬使用變量骰子後可能會出現的強化組合。下面為各功能簡單敘述:"})}),(0,s.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-white font-bold",children:"再洗一次"})}),(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-stone-400",children:"模擬使用變量骰子後所得到的結果"})})]}),(0,s.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-md font-bold text-white",children:"套用新強化"})}),(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-stone-400",children:"將對照的遺器資訊替換成目前重洗後的模樣"})})]}),(0,s.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-md font-bold text-white",children:"還原"})}),(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-stone-400",children:"將重洗次數以及遺器配置重設為一開始的配置。"})})]}),(0,s.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-md font-bold text-white",children:"更改模式"})}),(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-stone-400",children:"主要目的是模擬在不同強化次數的情況下所產生的結果為何，點選即可切換成另外一個模式。"})})]}),(0,s.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-md font-bold text-white",children:"注意事項"})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"!text-yellow-500",children:"1.重洗後的相關數據均存在誤差的可能，實際請以遊戲顯示的數值為主。"}),(0,s.jsx)("span",{className:"!text-yellow-500",children:"2.只有從Importer那邊過來的才會有更改模式按鈕。"})]})]})]})},h=t.memo(()=>{let[e,a]=(0,t.useState)(),{relic:x,standDetails:h,Rscore:v,Rrank:w,mode:N}=e||{},{getEnchantData:b}=(0,o.A)(),g=(0,t.useRef)(null),[D,k]=(0,t.useState)(!0),[y,S]=(0,t.useState)(!1),[A,C]=(0,t.useState)({oldData:null,newData:null}),[I,E]=(0,t.useState)(void 0),[F,M]=(0,t.useState)(2),[_,B]=(0,t.useState)(3),[R,L]=(0,t.useState)(!1),[O,P]=(0,t.useState)(0),[q,H]=(0,t.useState)(0),J=[{rank:"S+",stand:85,color:"rgb(239, 68, 68)",tag:"S+"},{rank:"S",stand:70,color:"rgb(239, 68, 68)",tag:"S"},{rank:"A",stand:50,color:"rgb(234, 179, 8)",tag:"A"},{rank:"B",stand:35,color:"rgb(234, 88 , 12)",tag:"B"},{rank:"C",stand:15,color:"rgb(163, 230, 53)",tag:"C"},{rank:"D",stand:0,color:"rgb(22,163,74)",tag:"D"}],T=(0,m.useRouter)(),[U,V]=(0,t.useState)({min:void 0,max:void 0});function W(){let e=[];J.forEach(a=>{e.push({label:a.rank,value:0,color:a.color,tag:a.rank})}),E(e)}function Z(){switch(N){case"Importer":let e,a,s,t;e=new Worker(l.tu(new URL(l.p+l.u(444),l.b))),a=n.A.find(e=>e.fieldName===x.flat.reliquaryMainstat.mainPropId),s=[],null===A.oldData?x.flat.reliquarySubstats.forEach((e,a)=>{let l=n.A.find(a=>a.fieldName===e.appendPropId),t=e.statValue,i={index:a,subaffix:l.name,data:t};s.push(i)}):s=A.oldData.returnData,t={MainData:a.name,SubData:s,partsIndex:i.A[x.flat.equipType],standard:h,enchanceCount:_+1,limit:F},e.postMessage(t),e.onmessage=function(e){C({oldData:{relicscore:null===A.oldData?parseInt(v):A.oldData.relicscore,relicrank:null===A.oldData?w:A.oldData.relicrank,returnData:s},newData:e.data}),P(e=>e+=1),null!==A.oldData?parseInt(e.data.relicscore)>A.oldData.relicscore&&H(e=>e+=1):parseInt(e.data.relicscore)>v&&H(e=>e+=1)};break;case"Simulator":let r,c,d,o;r=new Worker(l.tu(new URL(l.p+l.u(301),l.b))),c=n.A.find(e=>e.name===x.main_affix),d=[],null===A.oldData?(console.log(x),x.subaffix.forEach((e,a)=>{let l={index:a,subaffix:n.A.find(a=>a.name===e.subaffix).name,data:e.data,count:e.count,isSelect:e.isSelect};d.push(l)})):d=A.oldData.returnData,o={MainData:c.name,SubData:d,partsIndex:x.type,standard:h,enchanceCount:_+1,limit:F},r.postMessage(o),r.onmessage=function(e){C({oldData:{relicscore:null===A.oldData?v:A.oldData.relicscore,relicrank:null===A.oldData?w:A.oldData.relicrank,returnData:d},newData:e.data}),P(e=>e+=1),null!==A.oldData?parseInt(e.data.relicscore)>A.oldData.relicscore&&H(e=>e+=1):parseInt(e.data.relicscore)>v&&H(e=>e+=1)}}S(!0)}function G(){P(0),H(0),S(!1),console.log(g.current),C({oldData:g.current,newData:null}),V({min:void 0,max:void 0}),W()}(0,t.useEffect)(()=>{let e=b();e&&0!==Object.keys(e).length?(a(e),M(e.limit)):(alert("沒有任何模擬數據，即將導回至主頁"),T.push("./"))},[]),(0,t.useEffect)(()=>{if(void 0!==e&&"Simulator"===N){let a=0;e.relic.subaffix.forEach(e=>a+=e.count),5===a?B(4):B(3)}},[e]),(0,t.useEffect)(()=>{"Importer"===N?L(!0):L(!1),requestAnimationFrame(()=>{window.scrollTo({top:0,behavior:"smooth"})}),W(),Z()},[e]),(0,t.useEffect)(()=>{(function(){let e=A.newData;if(null!==e){let a=e.relicrank.rank,l=J.find(e=>e.tag===a);if(!l)return;if(void 0===I)return E([{label:a,value:1,color:l.color,tag:a}]);if(I.find(e=>e.label===a))E(e=>e.map(e=>e.tag===a?{...e,value:e.value+1}:e));else{let e={label:a,value:1,color:l.color,tag:a};E(a=>[...a,e])}}})(),null===g.current&&(g.current=A.oldData),function(){if(null!==A.oldData&&null!==A.newData){if(1===O)V({min:Math.min(A.oldData.relicscore,A.newData.relicscore),max:Math.max(A.oldData.relicscore,A.newData.relicscore)});else if(O>1){let e=A.newData.relicscore,a=JSON.parse(JSON.stringify(U));e>a.max?a.max=e:e<a.min&&(a.min=e),V(a)}}}()},[A]);let z=void 0!==A.newData&&void 0!==A.oldData?(0,s.jsxs)("div",{className:"flex flex-row flex-wrap  max-[600px]:!flex-col",children:[(0,s.jsx)(p,{standDetails:h,data:A.oldData,title:"重洗前"}),(0,s.jsxs)("div",{className:"flex my-auto w-[30px] moveAnimate moveAnimate2 max-[600px]:w-full h-[30px] ".concat(null===A.newData?"hidden":""),children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"max-[600px]:hidden mx-auto",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#FFFFFF",children:(0,s.jsx)("path",{d:"m560-240-56-58 142-142H160v-80h486L504-662l56-58 240 240-240 240Z"})}),(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"min-[600px]:hidden mx-auto",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#e8eaed",children:(0,s.jsx)("path",{d:"M440-800v487L216-537l-56 57 320 320 320-320-56-57-224 224v-487h-80Z"})})]}),(0,s.jsx)(p,{standDetails:h,data:A.newData,title:"重洗後"})]}):null;return(0,s.jsxs)(d.A.Provider,{value:{relic:x,Rrank:w,Rscore:v,standDetails:h,isChangeAble:D,partArr:["生之花","死之羽","時之沙","空之杯","理之冠"],PieNums:I,successCount:q,count:O,limit:F,MinMaxScore:U},children:[(0,s.jsx)("div",{className:"flex flex-col w-4/5 mx-auto max-[600px]:w-[90%]",children:(0,s.jsxs)("div",{className:"w-full border-gray-600 my-4 justify-center flex flex-row flex-wrap max-[900px]:flex-col",children:[(0,s.jsxs)("div",{className:"flex flex-row flex-wrap w-1/2 max-[900px]:w-full justify-evenly max-[900px]:mb-2",children:[(0,s.jsx)("div",{className:"w-[45%] h-fit flex flex-row max-[900px]:w-fit bg-[rgba(0,0,0,0.5)] p-2 rounded-md",children:"Importer"===N?(0,s.jsx)(c.G,{}):(0,s.jsx)(c.v,{})}),(0,s.jsx)("div",{className:"w-[45%] h-fit max-[900px]:w-fit bg-[rgba(0,0,0,0.5)] p-2 rounded-md ml-1 max-[900px]:ml-0 max-[900px]:my-2",children:(0,s.jsx)(r.V,{})})]}),(0,s.jsxs)("div",{className:"w-1/2 bg-[rgba(0,0,0,0.5)] h-fit p-2 rounded-md max-[900px]:w-full flex flex-col max-[900px]:items-center",children:[(0,s.jsxs)("div",{className:"flex flex-row max-[600px]:!flex-col",children:[(0,s.jsxs)("div",{className:"items-center flex flex-row max-[600px]:justify-center max-[600px]:mb-3",children:[(0,s.jsx)("span",{className:"text-red-600 text-lg font-bold",children:"模擬強化"}),(0,s.jsx)("div",{className:"hintIcon ml-2 overflow-visible","data-tooltip-id":"EnchantHint",children:(0,s.jsx)("span",{className:"text-white",children:"?"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{className:"processBtn ml-2",onClick:()=>Z(),children:"再洗一次"}),(0,s.jsx)("button",{className:"processBtn ml-2",onClick:()=>void(null!==A.newData&&(C({oldData:A.newData,newData:null}),H(0),S(!0))),children:"套用新強化"}),R?(0,s.jsx)("button",{className:"processBtn ml-2",onClick:()=>void(3===_?B(4):4===_&&B(3),G()),children:"更改模式"}):null,(0,s.jsx)("button",{className:"processBtn ml-2",onClick:()=>G(),disabled:!y,children:"還原"})]})]}),(0,s.jsxs)("div",{className:"my-2 flex flex-row",children:[(0,s.jsxs)("span",{children:["目前重洗次數:",(0,s.jsx)("span",{className:"text-white ml-1",children:O})]}),(0,s.jsxs)("span",{className:"ml-2",children:["目前模式:",(0,s.jsx)("span",{className:"text-white ml-1",children:_+"詞條"})]})]}),(0,s.jsx)("div",{children:z}),(0,s.jsx)("div",{children:(0,s.jsx)(j,{})})]})]})}),(0,s.jsx)(f.m_,{id:"EnchantHint",place:"right-start",render:()=>(0,s.jsx)(u,{})})]})}),p=t.memo(e=>{let{standDetails:a,data:l,title:t}=e,i=[];return null!==l?(l.returnData.map((e,l)=>{let t,r="";var c=n.A.find(a=>a.name===e.subaffix);let x=void 0!==a.find(a=>a.name===e.subaffix);switch(t=c.percent&&!e.data.toString().includes("%")?e.data+"%":e.data,e.count){case 0:r="rgb(122, 122, 122)";break;case 1:r="rgb(67, 143, 67)";break;case 2:r="rgb(23, 93, 232)";break;case 3:r="rgb(67, 17, 184)";break;case 4:r="rgb(219, 171, 15)";break;case 5:r="#FF55FF"}i.push((0,s.jsxs)("div",{className:"flex flex-row",children:[void 0!==e.count?(0,s.jsx)("div",{className:"flex justify-center items-center",children:(0,s.jsx)("span",{className:"mr-0.5 text-white w-[20px] h-[20px] rounded-[20px]   flex justify-center items-center",style:{backgroundColor:r},children:e.count})}):null,(0,s.jsx)("div",{className:"w-[120px] flex flex-row",children:(0,s.jsx)("span",{className:"".concat(x?"text-yellow-500 font-bold":"text-white"," text-left flex"),children:e.subaffix})}),(0,s.jsxs)("span",{className:"flex w-[70px]",children:[":",(0,s.jsx)("span",{className:"ml-2 text-white ",children:t})]})]},"Subaffix_"+e.subaffix))}),(0,s.jsxs)("div",{className:"flex flex-col mx-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-amber-700 font-bold text-lg",children:t}),(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("span",{children:"遺器評級:"}),(0,s.jsxs)("span",{className:"pl-2",style:{color:l.relicrank.color},children:[l.relicrank.rank," ",l.relicscore,"/100"]})]})]}),(0,s.jsx)("div",{children:i})]})):null}),j=t.memo(()=>{let{PieNums:e,successCount:a,count:l,MinMaxScore:n}=(0,t.useContext)(d.A);return void 0!==e?(0,s.jsxs)("div",{className:"w-full flex flex-row flex-wrap justify-evenly max-[500px]:flex-col-reverse",children:[(0,s.jsx)("div",{className:"w-[200px]",children:(0,s.jsx)(x.r,{series:[{innerRadius:20,arcLabelMinAngle:35,arcLabel:e=>"".concat(e.value,"次"),data:e}],height:200*(0!==l),margin:{top:10,right:0,bottom:0,left:0},egend:{hidden:!0}})}),(0,s.jsxs)("div",{className:"flex-col w-2/5 max-[500px]:w-full mt-2 ".concat(void 0===e.find(e=>0!==e.value)?"hidden":""),children:[(0,s.jsxs)("div",{className:"flex flex-row items-center max-[600px]:w-3/5 max-[600px]:mx-auto",children:[(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsx)("span",{className:"text-stone-400",children:"翻盤次數"})}),(0,s.jsx)("div",{className:"flex justify-start text-center ml-2",children:(0,s.jsxs)("span",{className:"text-white",children:[a,"次"]})})]}),(0,s.jsxs)("div",{className:"flex flex-row items-center max-[600px]:w-3/5 max-[600px]:mx-auto",children:[(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsx)("span",{className:"text-stone-400",children:"最高分數"})}),(0,s.jsx)("div",{className:"flex justify-start text-center ml-2",children:(0,s.jsx)("span",{className:"text-white",children:n.max})})]}),(0,s.jsxs)("div",{className:"flex flex-row items-center max-[600px]:w-3/5 max-[600px]:mx-auto",children:[(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsx)("span",{className:"text-stone-400",children:"最低分數"})}),(0,s.jsx)("div",{className:"flex justify-start text-center ml-2",children:(0,s.jsx)("span",{className:"text-white",children:n.min})})]})]})]}):null}),v=h}},e=>{var a=a=>e(e.s=a);e.O(0,[30,665,935,224,704,162,441,684,358],()=>a(2955)),_N_E=e.O()}]);